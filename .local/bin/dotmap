#!/usr/bin/env zsh

# stow/unstow dotfiles
# MAKE SURE ALL THE VARIABLES HERE ARE DEFINED. When the dotfiles are unstowed, the shell loses access to the variables defined in its RC files.
DOTFILES=${${2:-$DOTFILES}:-$HOME/other/dotfiles}
print "DOTFILES: $DOTFILES"
[[ -z $DOTFILES ]] && print "No directory at $DOTFILES" && exit 5
state=/tmp/state_stow
pwd=`pwd`
[[ $pwd != $DOTFILES ]] && pushd $DOTFILES
case $1 in
    (stow) stow -t ~ -R . && echo "stowed" > $state;;
    (unstow) stow -t ~ -D . && echo "unstowed" > $state;;
    (*) break;;
esac
[[ $pwd != $DOTFILES ]] && popd
true